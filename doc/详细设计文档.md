# 详细设计文档

## 文档修改历史

| 修改人员 | 日期      | 修改原因                     | 版本号 |
| -------- | --------- | ---------------------------- | ------ |
| 吴昊宇   | 2020.5.23 | 初始化文档                   | 0.1    |
| 李邦国   | 2020.5.25 | 增加展示层                   | 0.2    |
| 李昊天   | 2020.5.26 | 增加数据层                   | 0.3    |
| 吴昊宇   | 2020.5.26 | 更改展示层，增加展示层相关图 | 0.4    |
| 梅昊 | 2020.5.26 | 增加业务逻辑层 | 0.5 |
| 吴昊宇   | 2020.5.27 | 增加展示层相关图             | 0.6   |
| 梅昊   | 2020.5.27 | 增加业务逻辑层内容 | 0.7  |
| 梅昊 | 2020.5.28 | 增加业务逻辑层内容 | 0.8 |
| 吴昊宇 | 2020.5.28 | 增加展示层相关图 | 0.9 |
| 李昊天 | 2020.5.28 | 增加数据层相关图 | 0.10 |
| 梅昊 | 2020.5.28 | 增加业务逻辑层内容 | 0.11 |
| 梅昊 | 2020.6.12 | 增加业务逻辑层图例 | 0.12 |
| 吴昊宇 | 2020.6.13 | 更改展示层内容，相关图 | 0.13 |
| 梅昊 | 2020.6.14 | 增加业务逻辑层图例 | 0.14 |
| 梅昊 | 2020.6.16 | 增加业务逻辑层图例 | 0.15 |
| 李邦国 | 2020.6.27 | 更改展示层 | 1.0 |

## 目录

[TOC]

## 1. 引言

### 1.1 编制目的

​	     本报告详细完成对酒店预订系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。

​		本报告面向开发人员、测试及最终用户而编写，是了解系统的导航。

### 1.2 词汇表

|  词汇名称  | 词汇含义                                   | 备注 |
| :--------: | ------------------------------------------ | ---- |
|    vue     | 一套用于构建用户界面的渐进式JavaScript框架 | ...  |
| springboot | Java平台上的一种开源应用框架               | ...  |
|    ...     | ...                                        | ...  |

### 1.3 参考资料

无

## 2. 产品概述

参考酒店预订系统用例文档和酒店预订系统软件需求规格说明中对产品的概括描述

## 3. 体系结构设计概述

参考酒店体系结构文档中逻辑视图对体系结构设计的概述

## 4. 结构视角

### 4.1 展示层的分解

#### 4.1.1 admin模块

##### （1）模块概述

- admin模块主要负责网站管理员对于系统的使用

#####  （2）整体结构

- 根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。admin的页面中会受到由用户点击传来的数据以及方法，然后将数据传给admin模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/adminView1.png)

###### 模块各个类的职责表

| 模块             | 职责                                       |
| ---------------- | ------------------------------------------ |
| addManagerModal  | 完成增加网站管理员的页面显示以及数据收集   |
| addUserModal     | 完成增加用户的页面显示以及数据收集         |
| addMarketerModal | 完成增加网站营销人员的页面显示以及数据收集 |
| manageUser       | 浏览用户列表、删除用户                     |

##### （3）模块内部类接口规范

- addManagerModal的接口规范
- 提供的服务（供接口）

| getManagerListAPI | **语法** **无**                                         |
| ----------------- | ------------------------------------------------------- |
|                   | **前置条件** 已经存在一个managerList                    |
|                   | **后置条件** 调用adminController里面的getAllManager方法 |

| addManagerAPI | **语法**  无                                            |
| ------------- | ------------------------------------------------------- |
|               | **前置条件**  已创建一个manager对象，并输入符合输入规则 |
|               | **后置条件**  调用adminController里面的addManager方法   |

| 需要的服务（需接口）          | 作用                         |
| ----------------------------- | ---------------------------- |
| adminController.getAllManager | 实现得到酒店管理员列表的逻辑 |
| adminController.addManager    | 实现添加酒店管理员的逻辑     |

- addUserModal的接口规范
- 提供的服务（供接口）

| getUserListAPI | **语法** 无                                           |
| -------------- | ----------------------------------------------------- |
|                | **前置条件**  已经存在一个userList                    |
|                | **后置条件 ** 调用adminController里面的getAllUser方法 |

| addUserAPI | **语法**  无                                         |
| ---------- | ---------------------------------------------------- |
|            | **前置条件**  已创建一个user对象，并输入符合输入规则 |
|            | **后置条件 ** 调用adminController里面的addUser方法   |

| 需要的服务（需接口）       | 作用                   |
| -------------------------- | ---------------------- |
| adminController.getAllUser | 实现得到用户列表的逻辑 |
| adminController.addUser    | 实现添加用户的逻辑     |

- addMarketModal的接口规范
- 提供的服务（供接口）

| getMarketerListAPI | **语法** 无                                               |
| ------------------ | --------------------------------------------------------- |
|                    | **前置条件**  已经存在一个marketerList                    |
|                    | **后置条件 ** 调用adminController里面的getAllMarketer方法 |

| addMarketerAPI | **语法**  无                                             |
| -------------- | -------------------------------------------------------- |
|                | **前置条件**  已创建一个marketer对象，并输入符合输入规则 |
|                | **后置条件 ** 调用adminController里面的addMarketer方法   |

| 需要的服务（需接口）           | 作用                         |
| ------------------------------ | ---------------------------- |
| adminController.getAllMarketer | 实现得到网站营销员列表的逻辑 |
| adminController.addMarketer    | 实现添加网站营销员的逻辑     |

- manageUser的接口规范
- 提供的服务（供接口）

| deleteUserAPI | **语法** 无                                           |
| ------------- | ----------------------------------------------------- |
|               | **前置条件**  已经存在一个user对象                    |
|               | **后置条件 ** 调用adminController里面的DeleteUser方法 |

| 需要的服务（需接口）       | 作用               |
| -------------------------- | ------------------ |
| adminController.DeleteUser | 实现删除用户的逻辑 |

- roomList的接口规范

无接口

##### （4）展示层的动态模型

下图是添加酒店管理人员时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin1.png" style="zoom: 67%;" />

下图是添加客户时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin2.png" style="zoom: 67%;" />

下图是添加网站营销人员时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin3.png" style="zoom:67%;" />

下图是获取酒店管理人员列表时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin4.png" style="zoom:67%;" />

下图是获取客户列表时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin5.png" style="zoom:67%;" />

下图是获取网站营销人员列表时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin6.png" style="zoom:67%;" />

下图是删除酒店管理人员时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin7.png" style="zoom:67%;" />

下图是删除客户时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin8.png" style="zoom:67%;" />

下图是删除网站营销人员时，admin模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/admin%E9%A1%BA%E5%BA%8F%E5%9B%BE/admin9.png" style="zoom:67%;" />

如下图所示的状态图描述了admin内部对象的生存期间的状态序列、引起转移的条件，以及因状态转移而伴随的动作。随着跳转到manageUser页面，首先进入的是酒店管理人员账户管理页面（tabkey=1），之后可通过tab键切换到用户账户管理页面（tabkey=2）和网站营销管理页面（tabkey=3），在这三个页面都可调用各自的删除用户方法。在酒店管理人员账户管理页面调用addManager方法可打开addManagerModal；在用户账户管理页面调用addUser方法可打开addUserModal；在网站营销人员页面调用addMarketer方法可打开addMarketerModal。

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/adminView2.png)

##### （5）展示层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，再由各个界面模块中的方法委托给api传递给对应后端对象

#### 4.1.2 hotel模块

##### （1）模块概述

- hotel模块主要负责有关酒店信息以及酒店房间预定的使用

#####  （2）整体结构

- 根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotel的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotel模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelView1.1.png)

###### 模块各个类的职责表

| 模块          | 职责                                 |
| ------------- | ------------------------------------ |
| hotelList     | 所有酒店的相关信息的页面显示         |
| hotelDetail   | 展示选中酒店的详细信息               |
| hotelCard     | 各个酒店相关信息的页面显示           |
| hotelOrders   | 登录用户在该酒店的所有订单的页面显示 |
| orderModal    | 酒店预订的页面显示以及相关数据收集   |
| roomList      | 显示酒店的房型信息以及预定酒店       |
| hotelComments | 显示酒店的所有评论和评分             |

##### （3）模块内部类接口规范

- hotelList的接口规范
- 提供的服务（供接口）

| getHotelsAPI | **语法** **无**                                             |
| ------------ | ----------------------------------------------------------- |
|              | **前置条件** 已经存在一个hotelList                          |
|              | **后置条件** 调用hotelController里面的retrieveAllHotels方法 |

| 需要的服务（需接口）              | 作用                   |
| --------------------------------- | ---------------------- |
| hotelController.retrieveAllHotels | 实现获取所有酒店的逻辑 |

- hotelDetail的接口规范
- 提供的服务（供接口）

| getHotelByIdAPI | **语法** **无**                                              |
| --------------- | ------------------------------------------------------------ |
|                 | **前置条件** 已经存在一个hotel对象                           |
|                 | **后置条件** 调用hotelController里面的retrieveHotelDetail方法 |

| 需要的服务（需接口）                | 作用                       |
| ----------------------------------- | -------------------------- |
| hotelController.retrieveHotelDetail | 实现获取酒店详细信息的逻辑 |

- hotelCard的接口规范
- 提供的服务（供接口）

| getHotelByIdAPI | **语法** **无**                                              |
| --------------- | ------------------------------------------------------------ |
|                 | **前置条件** 已经存在一个hotel对象                           |
|                 | **后置条件** 调用hotelController里面的retrieveHotelDetail方法 |

| 需要的服务（需接口）                | 作用                       |
| ----------------------------------- | -------------------------- |
| hotelController.retrieveHotelDetail | 实现获取酒店详细信息的逻辑 |

- hotelOrders的接口规范
- 提供的服务（供接口）

| hotelOrdersAPI | **语法** 无                                                  |
| -------------- | ------------------------------------------------------------ |
|                | **前置条件**  已经存在一个orderList                          |
|                | **后置条件 ** 调用orderController里面的retrieveHotelOrders方法 |

| 需要的服务（需接口）                | 作用                       |
| ----------------------------------- | -------------------------- |
| hotelController.retrieveHotelOrders | 实现获取所有所属订单的逻辑 |

- orderModal的接口规范
- 提供的服务（供接口）

| reserveHotelAPI | **语法** 无                                               |
| --------------- | --------------------------------------------------------- |
|                 | **前置条件**  已经新建了一个order对象，并输入符合输入规则 |
|                 | **后置条件 ** 调用hotelController里面的reserveHotel方法   |

| orderMatchCouponsAPI | **语法** 无                                                  |
| -------------------- | ------------------------------------------------------------ |
|                      | **前置条件**  已经新建了一个order对象，并输入符合输入规则    |
|                      | **后置条件 ** 调用couponController里面的getOrderMatchCoupons方法 |

| 需要的服务（需接口）                 | 作用                             |
| ------------------------------------ | -------------------------------- |
| hotelController.reserveHotel         | 实现查看订单的逻辑               |
| hotelController.getOrderMatchCoupons | 实现得到订单满足的所有优惠的逻辑 |

- hotelComments的接口规范

| getCommentsByHotelId | **语法** 无                                                  |
| -------------------- | ------------------------------------------------------------ |
|                      | **前置条件**  已经存在一个hotelComments                      |
|                      | **后置条件**  调用orderController里面的getCommentsByHotelId方法 |

##### （4）展示层的动态模型

下图是加载酒店列表页面时，hotel模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotel%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotel1.png" style="zoom:67%;" />

下图是跳转到酒店详情页面时，hotel模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotel%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotel2.png" style="zoom:67%;" />

下图是获取该用户在该酒店的订单时，hotel模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotel%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotel3.png" style="zoom:67%;" />

下图是预定酒店时，hotel模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotel%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotel4.png" style="zoom:67%;" />

下图是获取酒店评论时，hotel模块内部对象之间的协作

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotel%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotel5.png" style="zoom:67%;" />

如下图所示的状态图描述了hotel内部对象的生存期间的状态序列、引起转移的条件，以及因状态转移而伴随的动作。随着用户在hotelList点击hotelCard进入hotelDetail页面，首先进入的是由roomList和hotelDetail组合而成的页面（tabkey=1），之后可通过tab键切换到由hotelOrders和hotelDetail组合而成的页面（tabkey=2）和hotelComments和hotelDetail组合而成的页面（tabkey=3）。在tabkey=1的页面可调用order方法打开orderModal。

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelView2.1.png)

##### （5）展示层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，再由各个界面模块中的方法委托给api传递给对应后端对象

#### 4.1.3 hotelManager模块

##### （1）模块概述

- hotelManager模块主要负责酒店管理人员对于系统的使用

#####  （2）整体结构

- 根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotelManager的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotelManager和coupon模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManagerView1.png)

###### 模块各个类的职责表

| 模块          | 职责                                 |
| ------------- | ------------------------------------ |
| addCoupon     | 添加优惠的页面显示以及相关数据收集   |
| addHotelModal | 添加酒店的页面显示以及相关数据收集   |
| addRoomModal  | 添加房间的页面显示以及相关数据收集   |
| coupon        | 酒店优惠措施的显示，以及取消优惠措施 |
| manageHotel   | 删除酒店以及删除酒店里的相关订单     |

##### （3）模块内部类接口规范

- addCoupon的接口规范

| hotelTargetMoneyAPI | **语法** **无**                                              |
| ------------------- | ------------------------------------------------------------ |
|                     | **前置条件** 已经创建一个coupon对象，并且输入符合输入规范    |
|                     | **后置条件** 调用couponController里面的addHotelTargetMoneyCoupon方法 |

| hotelMultiplyRoomsAPI | **语法** **无**                                              |
| --------------------- | ------------------------------------------------------------ |
|                       | **前置条件** 已经创建一个coupon对象，并且输入符合输入规范    |
|                       | **后置条件** 调用couponController里面的addHotelMultiplyRoomsCoupon方法 |

| hotelFestivalAPI | **语法** **无**                                              |
| ---------------- | ------------------------------------------------------------ |
|                  | **前置条件** 已经创建一个coupon对象，并且输入符合输入规范    |
|                  | **后置条件** 调用couponController里面的addHotelFestivalCoupon方法 |

| hotelBirthdayAPI | **语法** **无**                                              |
| ---------------- | ------------------------------------------------------------ |
|                  | **前置条件** 已经创建一个coupon对象，并且输入符合输入规范    |
|                  | **后置条件** 调用couponController里面的addHotelBirthdayCoupon方法 |

- addHotelModal的接口规范

| addHotelAPI | **语法** **无**                                          |
| ----------- | -------------------------------------------------------- |
|             | **前置条件** 已经创建一个hotel对象，并且输入符合输入规范 |
|             | **后置条件** 调用hotelController里面的createHotel方法    |

- addRoomModal的接口规范

| addRoomAPI | **语法** **无**                                         |
| ---------- | ------------------------------------------------------- |
|            | **前置条件** 已经创建一个room对象，并且输入符合输入规范 |
|            | **后置条件** 调用hotelController里面的addRoomInfo方法   |

- coupon的接口规范

| hotelAllCouponsAPI | **语法** **无**                                              |
| ------------------ | ------------------------------------------------------------ |
|                    | **前置条件** 已经存在一个couponList                          |
|                    | **后置条件** 调用couponController里面的getHotelAllCoupons方法 |

- manageHotel的接口规范

| deleteHotelAPI | **语法** **无**                                       |
| -------------- | ----------------------------------------------------- |
|                | **前置条件** 已经存在一个hotel对象                    |
|                | **后置条件** 调用hotelController里面的deleteHotel方法 |

| cancelOrderAPI | **语法** **无**                                      |
| -------------- | ---------------------------------------------------- |
|                | **前置条件** 已经存在一个order对象                   |
|                | **后置条件** 调用orderController里面的annulOrder方法 |

##### （4）展示层的动态模型

下图是获取酒店时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager1.png" style="zoom:67%;" />

下图是获取订单时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager2.png" style="zoom:67%;" />

下图是删除酒店时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager3.png" style="zoom:67%;" />

下图是删除订单时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager4.png" style="zoom:67%;" />

下图是添加酒店时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager5.png" style="zoom:67%;" />

下图是录入房间时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager6.png" style="zoom:67%;" />

下图是浏览酒店优惠策略并添加优惠策略时，hotelManagr模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManager%E9%A1%BA%E5%BA%8F%E5%9B%BE/hotelManager7.png" style="zoom:67%;" />

如下图所示的状态图描述了hotelManager内部对象的生存期间的状态序列、引起转移的条件，以及因状态转移而伴随的动作。随着用户在进入manageHotel页面，首先进入的是由酒店管理页面（tabkey=1），之后可通过tab键切换到订单管理页面（tabkey=2）。在酒店管理页面可调用addRoom方法打开addRoomModal；可调用addHotel方法打开addHotelModal；可调用showCoupon方法打开coupon，在coupon界面可调用addCoupon打开addCoupon；在订单管理页面可以删除订单。



![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/hotelManagerView2.png)

##### （5）展示层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，再由各个界面模块中的方法委托给api传递给对应后端对象

#### 4.1.4 marketer模块

##### （1）模块概述

- marketer模块主要负责酒店营销人员对于系统的使用

#####  （2）整体结构

- 根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。marketer的页面中会受到由用户点击传来的数据以及方法，然后将数据传给marketer模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/marketerView1.1.png)

###### 模块各个类的职责表

| 模块              | 职责                                   |
| ----------------- | -------------------------------------- |
| addWebCouponModal | 添加优惠的页面显示以及相关数据收集     |
| marketing         | 进行用户信用充值，显示网站优惠策略列表 |

##### （3）模块内部类接口规范

- addWebcouponModal的接口规范

| hotelFestivalAPI | **语法** **无**                                              |
| ---------------- | ------------------------------------------------------------ |
|                  | **前置条件** 已经创建一个coupon对象，并且输入符合输入规范    |
|                  | **后置条件** 调用couponController里面的addHotelFestivalCoupon方法 |

- marketing的接口规范

| creditDepositAPI | **语法** **无**                                        |
| ---------------- | ------------------------------------------------------ |
|                  | **前置条件** 已经存在一个user对象                      |
|                  | **后置条件** 调用userController里面的creditDeposit方法 |

| hotelAllCouponsAPI | **语法** **无**                                              |
| ------------------ | ------------------------------------------------------------ |
|                    | **前置条件** 已经存在一个marketerCouponList                  |
|                    | **后置条件** 调用couponController里面的getHotelAllCoupons方法 |

| setVipAPI | **语法** **无**                                 |
| --------- | ----------------------------------------------- |
|           | **前置条件** 已经存在一个user对象               |
|           | **后置条件** 调用userController里面的setVip方法 |

##### （4）展示层的动态模型

下图是获取网站优惠策略时，marketer模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/marketer%E9%A1%BA%E5%BA%8F%E5%9B%BE/marketer1.png" style="zoom:67%;" />

下图是信用充值时，marketer模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/marketer%E9%A1%BA%E5%BA%8F%E5%9B%BE/marketer2.png" style="zoom:67%;" />

下图是增加网站优惠策略时，marketer模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/marketer%E9%A1%BA%E5%BA%8F%E5%9B%BE/marketer3.1.png" style="zoom:67%;" />

下图是会员充值时，marketer模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/marketer%E9%A1%BA%E5%BA%8F%E5%9B%BE/marketer4.png" style="zoom:67%;" />

如下图所示的状态图描述了marketer内部对象的生存期间的状态序列、引起转移的条件，以及因状态转移而伴随的动作。随着用户在进入marketing页面，首先进入的是由网站优惠策略页面（tabkey=1），之后可通过tab键切换到信用充值页面（tabkey=2）和会员充值页面（tabkey=3）。在网站优惠策略页面可调用addWebCoupon方法打开addWebCouponModal。在信用充值页面可以充值信用。在会员充值页面可以充值会员。

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/marketerView2.1.png)

##### （5）展示层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，再由各个界面模块中的方法委托给api传递给对应后端对象

#### 4.1.5 user模块

##### （1）模块概述

- user模块主要负责客户对于系统的使用

#####  （2）整体结构

- 根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。user的页面中会受到由用户点击传来的数据以及方法，然后将数据传给user模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/userView1.1.png)

###### 模块各个类的职责表

| 模块        | 职责           |
| ----------- | -------------- |
| info        | 用户的相关操作 |
| orderDetail | 查看订单详情   |
| rateHotel   | 对酒店进行评价 |

##### （3）模块内部类接口规范

- info的接口规范

| loginAPI | **语法** **无**                                         |
| -------- | ------------------------------------------------------- |
|          | **前置条件** 已经创建一个user对象，并且输入符合输入规范 |
|          | **后置条件** 调用accountController里面的login方法       |

| getUserInfoAPI | **语法** **无**                                         |
| -------------- | ------------------------------------------------------- |
|                | **前置条件** 已经创建一个user对象                       |
|                | **后置条件** 调用accountController里面的getUserInfo方法 |

| updateUserInfoAPI | **语法** **无**                                        |
| ----------------- | ------------------------------------------------------ |
|                   | **前置条件** 已经创建一个user对象                      |
|                   | **后置条件** 调用accountController里面的updateInfo方法 |

| cancelOrderAPI | **语法** **无**                                      |
| -------------- | ---------------------------------------------------- |
|                | **前置条件** userOrderList里有Order对象              |
|                | **后置条件** 调用orderController里面的annulOrder方法 |

- orderDetail的接口规范

| getOrderById | **语法** **无**                                           |
| ------------ | --------------------------------------------------------- |
|              | **前置条件** 已经有currentOrderId和currentOrderInfo       |
|              | **后置条件** 调用orderController里面的orderDetailById方法 |

- rateHotel的接口规范

| rateHotelAPI | **语法** **无**                                     |
| ------------ | --------------------------------------------------- |
|              | **前置条件** userOrderList里有Order对象             |
|              | **后置条件** 调用orderController里面的rateHotel方法 |

##### （4）展示层的动态模型

下图是获取用户信息时，user模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/user%E9%A1%BA%E5%BA%8F%E5%9B%BE/user1.png" style="zoom:67%;" />

下图是更改用户信息时，user模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/user%E9%A1%BA%E5%BA%8F%E5%9B%BE/user2.png" style="zoom:67%;" />

下图是获取用户订单信息时，user模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/user%E9%A1%BA%E5%BA%8F%E5%9B%BE/user3.png" style="zoom:67%;" />

下图是撤销订单时，user模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/user%E9%A1%BA%E5%BA%8F%E5%9B%BE/user4.png" style="zoom:67%;" />

下图是获取订单详情时，user模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/user%E9%A1%BA%E5%BA%8F%E5%9B%BE/user5.png" style="zoom:67%;" />

下图是评价酒店时，user模块内部对象之间的协作。

<img src="https://kashimiya.oss-cn-hangzhou.aliyuncs.com/user%E9%A1%BA%E5%BA%8F%E5%9B%BE/user6.png" style="zoom:67%;" />

如下图所示的状态图描述了user内部对象的生存期间的状态序列、引起转移的条件，以及因状态转移而伴随的动作。随着用户在进入info页面，首先进入的是由我的信息页面（tabkey=1），之后可通过tab键切换到我的订单页面（tabkey=2）。在我的信息页面可调用modifyInfo方法使modify=true，使该页面的部分个人信息进入可编辑状态，在此状态下可以saveModify。在我的订单页面可以对订单进行查看、删除、评价。

![](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/userView2.1.png)

##### （5）展示层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，再由各个界面模块中的方法委托给API传递给对应后端对象

### 4.2 业务逻辑层的分解 

#### 4.2.1 adminbl模块

（1）模块概述

adminbl模块主要负责网站管理员使用系统的逻辑

（2）整体结构

模块各个类的设计图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84/admin.jpg)

模块各个类的职责表

| 模块              | 职责                                       |
| ----------------- | ------------------------------------------ |
| AdminController类 | 负责实现对应网站管理界面所需要的服务       |
| AdminService类    | 网站管理领域模型对象，帮助完成网站管理任务 |

（3）模块内部类接口规范

AdminController的接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">AdminController.addManager</td>
      <td>语法</td>
      <td>public ResponseVO addManager(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>酒店管理人员信息输入符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的addManager方法</td>
   </tr>
   <tr>
      <td rowspan="3">AdminController.getAllManager</td>
      <td>语法</td>
      <td>public ResponseVO getAllManager();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>管理员已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的getAllManager方法</td>
   </tr>
    <tr>
      <td rowspan="3">AdminController.addUser</td>
      <td>语法</td>
      <td>public ResponseVO addUser(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>客户信息输入符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的addUser方法</td>
   </tr>
   <tr>
      <td rowspan="3">AdminController.getAllUser</td>
      <td>语法</td>
      <td>public ResponseVO getAllManagers();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>管理员已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的getAllUser方法</td>
   </tr>
    <tr>
      <td rowspan="3">AdminController.addMarketer</td>
      <td>语法</td>
      <td>public ResponseVO addMarketer(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>网站营销人员信息输入符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的addMarketer方法</td>
   </tr>
   <tr>
      <td rowspan="3">AdminController.getAllMarketer</td>
      <td>语法</td>
      <td>public ResponseVO getAllMarketer();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>管理员已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的getAllMarketer方法</td>
   </tr>
    <tr>
      <td rowspan="3">AdminController.deleteUser</td>
      <td>语法</td>
      <td>public ResponseVO deleteUser(Integer userId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>存在此id</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AdminService领域对象的deleteUser方法</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>AdminService.addManager(User user)</td>
      <td colspan="2">加入一个酒店管理人员对象</td>
   </tr>
   <tr>
      <td>AdminService.getAllManagers</td>
      <td  colspan="2">得到所有酒店管理人员对象</td>
   </tr>
   <tr>
      <td>AdminService.addUsers(User user)</td>
      <td colspan="2">加入一个客户对象</td>
   </tr>
   <tr>
      <td>AdminService.getAllUsers</td>
      <td  colspan="2">得到所有客户对象</td>
   </tr>
   <tr>
      <td>AdminService.addMarketer(User user)</td>
      <td colspan="2">加入一个网站营销人员对象</td>
   </tr>
   <tr>
      <td>AdminService.getAllMarketer</td>
      <td  colspan="2">得到所有网站营销人员对象</td>
   </tr>
   <tr>
      <td>AdminService.deleteUser(Integer userid)</td>
      <td colspan="2">删除一个用户对象</td>
   </tr>
</table>

Admin的接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">AdminService.addManager</td>
      <td>语法</td>
      <td>ResponseVO addManager(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>酒店管理人员信息输入符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>在数据库中增加酒店管理人员信息</td>
   </tr>
   <tr>
      <td rowspan="3">AdminService.getAllManagers</td>
      <td>语法</td>
      <td>List<User> getAllManagers();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>管理员已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有酒店管理人员的信息</td>
   </tr>
    <tr>
      <td rowspan="3">AdminService.addUser</td>
      <td>语法</td>
      <td>ResponseVO addUser(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>客户信息输入符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>在数据库中增加客户信息</td>
   </tr>
   <tr>
      <td rowspan="3">AdminService.getAllUser</td>
      <td>语法</td>
      <td>List<User> getAllUser();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>管理员已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有客户的信息</td>
   </tr>
    <tr>
      <td rowspan="3">AdminService.addMarketer</td>
      <td>语法</td>
      <td>ResponseVO addMarketer(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>网站营销人员信息输入符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>在数据库中增加网站营销人员信息</td>
   </tr>
   <tr>
      <td rowspan="3">AdminService.getAllMarketer</td>
      <td>语法</td>
      <td>List<User> getAllMarketer();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>管理员已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有网站营销人员的信息</td>
   </tr>
    <tr>
      <td rowspan="3">AdminService.deleteUser(Integer userid)</td>
      <td>语法</td>
      <td>ResponseVO deleteUser(Integer userid);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>删除用户</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>AdminMapper.addManager(User user)</td>
      <td colspan="2">在数据库中插入UserPO对象</td>
   </tr>
   <tr>
      <td>AdminMapper.getAllManagers</td>
      <td  colspan="2">得到User数据库的服务与引用</td>
   </tr>
   <tr>
      <td>AdminMapper.addUsers(User user)</td>
      <td colspan="2">在数据库中插入UserPO对象</td>
   </tr>
   <tr>
      <td>AdminMapper.getAllUsers</td>
      <td  colspan="2">得到User数据库的服务与引用</td>
   </tr>
   <tr>
      <td>AdminMapper.addMarketer(User user)</td>
      <td colspan="2">在数据库中插入UserPO对象</td>
   </tr>
   <tr>
      <td>AdminMapper.getAllMarketer</td>
      <td  colspan="2">得到User数据库的服务与引用</td>
   </tr>
   <tr>
      <td>AdminMapper.deleteUser(Integer userid)</td>
      <td colspan="2">在数据库中插入UserPO对象</td>
   </tr>
</table>
（4）业务逻辑层的动态模型

添加酒店管理人员的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/adminaddManager.png)

查看酒店管理人员信息的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/admingetallManagers.png)

添加客户的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/adminaddUser.png)

查看客户信息的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/admingetallUsers.png)

添加网站营销人员的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/adminaddMarketer.png)

查看网站营销人员信息的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/admingetallMarketers.png)

删除用户的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/admin/admindeleteUser.png)

（5）业务逻辑层的设计原理

利用委托式的控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域

#### 4.2.2 couponbl模块

（1）模块概述

couponbl模块主要负责优惠策略的逻辑

（2）整体结构

模块各个类的设计图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84/coupon.jpg)

模块各个类的职责表

| 模块                | 职责                                           |
| ------------------- | ---------------------------------------------- |
| CouponController    | 负责实现对应优惠策略界面所需要的服务           |
| CouponService       | 优惠策略领域模型对象，帮助完成优惠策略查询任务 |
| CouponMatchStrategy | 负责判断优惠策略是否可用                       |

（3）模块内部类接口规范

couponController的接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td  rowspan="3">CouponController.getOrderMatchCoupons</td>
      <td>语法</td>
      <td>public ResponseVO getOrderMatchCoupons(Integer userId,
                                           Integer hotelId,
                                           Double orderPrice,
                                           Integer roomNum,
                                           String checkIn,
                                           String checkOut);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单信息完全</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用CouponService领域对象的getMatchOrderCoupon方法</td>
   </tr>
   <tr>
      <td  rowspan="3">CouponController.getHotelAllCoupon</td>
      <td>语法</td>
      <td>public ResponseVO getHotelAllCoupon(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用CouponService领域对象的getHotelAllCoupon方法</td>
   </tr>
   <tr>
      <td  rowspan="3">CouponController.addHoteBirthdayCoupon</td>
      <td>语法</td>
      <td>public ResponseVO addHotelBirthdayCoupon(HotelBirthdayCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用CouponService领域对象的addHotelBirthdayCoupon方法</td>
   </tr>   
   <tr>
      <td  rowspan="3">CouponController.addHotelMultiplyRoomsCoupon</td>
      <td>语法</td>
      <td>public ResponseVO addHotelMultiplyRoomsCoupon(HotelMultiplyRoomsCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用CouponService领域对象的addHotelMultiplyRoomsCoupon方法</td>
   </tr>
    <tr>
      <td  rowspan="3">CouponController.addHotelTargetMoneyCoupon</td>
      <td>语法</td>
      <td>public ResponseVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用CouponService领域对象的addHotelTargetMoneyCoupon方法</td>
   </tr>   
    <tr>
      <td  rowspan="3">CouponController.addHotelFestivalCoupon</td>
      <td>语法</td>
      <td>public ResponseVO addHotelFestivalCoupon(HotelFestivalCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用CouponService领域对象的addHotelFestivalCoupon方法</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>CouponService.addHotelBirthdayCoupon(Coupon coupon)</td>
      <td colspan="2">添加生日优惠策略</td>
   </tr>
   <tr>
      <td>CouponService.addHotelMultiplyRoomsCoupon(Integer hotelId)</td>
      <td colspan="2">添加多间优惠策略</td>
   </tr>
       <tr>
      <td>CouponService.addHotelTargetMoneyCoupon(Coupon coupon)</td>
      <td colspan="2">添加满减优惠策略</td>
   </tr>
   <tr>
      <td>CouponService.addHotelFestivalCoupon(Integer hotelId)</td>
      <td colspan="2">添加节日优惠策略</td>
   </tr>
       <tr>
      <td>CouponService.getMatchOrderCoupon(Coupon coupon)</td>
      <td colspan="2">取得适用的优惠策略</td>
   </tr>
   <tr>
      <td>CouponService.getHotelAllCoupon(Integer hotelId)</td>
      <td colspan="2">取得某一酒店所有优惠策略</td>
   </tr>
</table>


Coupon的接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">CouponMatchStrategy.isMatch</td>
      <td>语法</td>
      <td>boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单信息完全</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回优惠策略是否适用于此订单</td>
   </tr>
   <tr>
      <td  rowspan="3">CouponService.getMatchOrderCoupon</td>
      <td>语法</td>
      <td>List<Coupon> getMatchOrderCoupon(OrderVO orderVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单信息完全</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有适用此订单的优惠策略</td>
   </tr>
   <tr>
      <td  rowspan="3">CouponService.getHotelAllCoupon</td>
      <td>语法</td>
      <td>List<Coupon> getHotelAllCoupon(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有此酒店的优惠策略</td>
   </tr>
   <tr>
      <td  rowspan="3">CouponService.addHotelBirthdayCoupon</td>
      <td>语法</td>
      <td>CouponVO addHotelBirthdayCoupon(HotelBirthdayCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>增加该酒店的生日优惠策略</td>
   </tr>
    <tr>
      <td  rowspan="3">CouponService.addHotelMultiplyRoomsCoupon</td>
      <td>语法</td>
      <td>CouponVO addHotelMultiplyRoomsCoupon(HotelMultiplyRoomsCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>增加该酒店的间数优惠策略</td>
   </tr>
    <tr>
      <td  rowspan="3">CouponService.addHotelTargetMoneyCoupon</td>
      <td>语法</td>
      <td>CouponVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>增加该酒店的满减优惠策略</td>
   </tr>
    <tr>
      <td  rowspan="3">CouponService.addHotelFestivalCoupon</td>
      <td>语法</td>
      <td>CouponVO addHotelFestivalCoupon(HotelFestivalCouponVO couponVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>增加该酒店的节日优惠策略</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>CouponMapper.insertCoupon(Coupon coupon)</td>
      <td colspan="2">在数据库中插入优惠策略单一持久化对象</td>
   </tr>
   <tr>
      <td>CouponMapper.selectByHotelId(Integer hotelId)</td>
      <td colspan="2">得到coupon数据库的服务与引用</td>
   </tr>
</table>
（4）业务逻辑层的动态模型

找到适合订单的优惠的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/coupon/coupongetOrderMatchCoupons.png)

找到某酒店所有优惠的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/coupon/coupongetHotelAllCoupon.png)

添加生日优惠策略的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/coupon/couponaddHotelBirthdayCoupon.png)

添加多间优惠策略的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/coupon/couponaddHotelMultiplyRoomsCoupon.png)

添加满减优惠策略的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/coupon/couponaddHotelTargetMoneyCoupon.png)

添加节日优惠策略的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/coupon/couponaddHotelFestivalCoupon.png)

（5）业务逻辑层的设计原理

利用委托式的控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域

#### 4.2.3 hotelbl模块

（1）模块概述

hotelbl模块主要负责酒店相关操作的逻辑

（2）整体结构

模块各个类的设计图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84/Hotel.jpg)

模块各个类的职责表

| 模块            | 职责                                       |
| --------------- | ------------------------------------------ |
| HotelController | 负责实现对应酒店管理界面所需要的服务       |
| HotelService    | 酒店管理领域模型对象，帮助完成酒店管理任务 |
| RoomService     | 负责完成酒店管理中房间管理的任务           |

（3）模块内部类接口规范

HotelController的接口与规范

<table>
   <tr>
      <td  colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">HotelController.createHotel</td>
      <td>语法</td>
      <td>public ResponseVO createHotel(HotelVO hotelVO) throws ServiceException;</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>无</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用HotelService领域对象的addHotel方法</td>
   </tr>
   <tr>
      <td rowspan="3">HotelController.retrieveAllHotels</td>
      <td>语法</td>
      <td>public ResponseVO retrieveAllHotels();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>无</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用HotelService领域对象的retrieveAllHotels方法</td>
   </tr>
   <tr>
      <td  rowspan="3">HotelController.addRoomInfo</td>
      <td>语法</td>
      <td>public ResponseVO addRoomInfo(HotelRoom hotelRoom);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>房间信息正确</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用RoomService领域对象的insertRoomInfo方法</td>
   </tr>
   <tr>
      <td rowspan="3">HotelController.retrieveHotelDetail</td>
      <td>语法</td>
      <td>public ResponseVO retrieveHotelDetail(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用HotelService领域对象的retrieveHotelDetail方法</td>
   </tr>
    <tr>
      <td rowspan="3">HotelController.deleteHotel</td>
      <td>语法</td>
      <td>public ResponseVO deleteHotel(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用HotelService领域对象的deleteHotel方法</td>
   </tr>
    <tr>
      <td rowspan="3">HotelController.getHotelsByManagerId</td>
      <td>语法</td>
      <td>public ResponseVO getHotelsByManagerId(Integer managerId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店管理人员</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用HotelService领域对象的getHotelsByManagerId方法</td>
   </tr>
   <tr>
      <td  colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>HotelService.addHotel(Hotel hotel)</td>
      <td  colspan="2">添加酒店</td>
   </tr>
   <tr>
      <td>HotelService.retrieveAllHotels</td>
      <td  colspan="2">取得所有酒店信息</td>
   </tr>
   <tr>
      <td>HotelService.retrieveHotelDetail(Integer hotelId)</td>
      <td colspan="2">取得酒店详细信息</td>
   </tr>
   <tr>
      <td>HotelService.deleteHotel(Integer hotelId)</td>
      <td colspan="2">删除酒店</td>
   </tr>
    <tr>
      <td>HotelService.getHotelsByManagerId(Integer managerId)</td>
      <td colspan="2">取得酒店详细信息</td>
   </tr>
   <tr>
      <td>RoomService.insertRoomInfo(HotelRoom hotelRoom)</td>
      <td colspan="2">添加房间信息</td>
   </tr>
</table>



Hotel的接口与规范

<table>
   <tr>
      <td  colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">HotelService.addHotel</td>
      <td>语法</td>
      <td>void addHotel(HotelVO hotelVO) throws ServiceException;</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>无</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>将酒店信息添加到数据库</td>
   </tr>
   <tr>
      <td rowspan="3">HotelService.updateRoomInfo</td>
      <td>语法</td>
      <td>void updateRoomInfo(Integer hotelId, String roomType,Integer rooms);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>酒店剩余可防信息修改</td>
   </tr>
   <tr>
      <td  rowspan="3">HotelService.retrieveHotels</td>
      <td>语法</td>
      <td>List<HotelVO> retrieveHotels();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>无</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有酒店信息</td>
   </tr>
   <tr>
      <td rowspan="3">HotelService.retrieveHotelDetails</td>
      <td>语法</td>
      <td>HotelVO retrieveHotelDetails(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回酒店详细信息</td>
   </tr>
   <tr>
      <td rowspan="3">HotelService.getRoomCurNum</td>
      <td>语法</td>
      <td>int getRoomCurNum(Integer hotelId,String roomType);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回酒店此种房间剩余数目</td>
   </tr>
   <tr>
      <td rowspan="3">HotelService.getHotelOrders</td>
      <td>语法</td>
      <td>List<Order> getHotelOrders(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回酒店所有订单</td>
   </tr>
    <tr>
      <td rowspan="3">HotelService.getHotelsByManagerId</td>
      <td>语法</td>
      <td>List<HotelVO> getHotelsByManagerId(Integer managerId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回酒店此种房间剩余数目</td>
   </tr>
   <tr>
      <td rowspan="3">RoomService.retrieveHotelRoomInfo</td>
      <td>语法</td>
      <td>List<HotelRoom> retrieveHotelRoomInfo(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回酒店全部房间信息</td>
   </tr>
   <tr>
      <td rowspan="3">RoomService.insertRoomInfo</td>
      <td>语法</td>
      <td>void insertRoomInfo(HotelRoom hotelRoom);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>在数据库中添加酒店客房信息</td>
   </tr>
   <tr>
      <td rowspan="3">RoomService.updateRoomInfo</td>
      <td>语法</td>
      <td>void updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店与房间</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>改变酒店客房数目信息</td>
   </tr>
   <tr>
      <td rowspan="3">RoomService.getRoomCurNum</td>
      <td>语法</td>
      <td>int getRoomCurNum(Integer hotelId, String roomType);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>数据库中存在对应的酒店</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回酒店此种房间剩余数目</td>
   </tr>
   <tr>
      <td  colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>HotelMapper.insertHotel(Hotel hotel)</td>
      <td  colspan="2">在数据库中添加收到的符合规范的酒店信息</td>
   </tr>
   <tr>
      <td>HotelMapper.selectAllHotel</td>
      <td  colspan="2">得到hotel数据库的服务与引用</td>
   </tr>
   <tr>
      <td>HotelMapper.selectById( Integer id)</td>
      <td colspan="2">根据ID进行查找单一持久化对象</td>
   </tr>
    <tr>
      <td>HotelMapper.getHotelsByManagerId(Integer managerId)</td>
      <td colspan="2">根据酒店管理人员ID进行查找多个持久化对象</td>
   </tr>
   <tr>
      <td>RoomMapper.updateRoomInfo(Integer hotelId, String roomType, Integer curNum)</td>
      <td colspan="2">在数据库中添加收到的符合规范的酒店房间信息</td>
   </tr>
   <tr>
      <td>RoomMapper.selectRoomsByHotelId( Integer hotelId)</td>
      <td colspan="2">根据酒店ID查找多个持久化对象</td>
   </tr>
   <tr>
      <td>RoomMapper.insertRoom(HotelRoom hotelRoom)</td>
      <td colspan="2">在数据库中添加收到的符合规范的房间信息</td>
   </tr>
   <tr>
      <td>RoomMapper.getRoomCurNum( Integer hotelId,String roomType)</td>
      <td colspan="2">根据ID与房间类型进行查找符合条件持久化对象的数目</td>
   </tr>
</table>
（4）业务逻辑层的动态模型

新建酒店的顺序图

得到所有酒店的顺序图

添加房间的顺序图

的顺序图

的顺序图

的顺序图

（5）业务逻辑层的设计原理

利用委托式的控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域

#### 4.2.4 orderbl模块

（1）模块概述

orderbl模块主要负责订单相关操作的逻辑

（2）整体结构

模块各个类的设计图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84/Hotel.jpg)

模块各个类的职责表

| 模块            | 职责                                       |
| --------------- | ------------------------------------------ |
| OrderController | 负责实现对应订单管理界面所需要的服务       |
| OrderService    | 订单管理领域模型对象，帮助完成订单管理任务 |

（3）模块内部类接口规范

OrderController的接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">OrderController.reserveHotel</td>
      <td>语法</td>
      <td>public ResponseVO reserveHotel(OrderVO orderVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的addOrder方法</td>
   </tr>
    <tr>
      <td rowspan="3">OrderController.retrieveAllOrders</td>
      <td>语法</td>
      <td>public ResponseVO retrieveAllOrders();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以酒店管理人员身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的getAllOrders方法</td>
   </tr>
    <tr>
      <td rowspan="3">OrderController.retrieveUserOrders</td>
      <td>语法</td>
      <td>public  ResponseVO retrieveUserOrders(int userid);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的getUserOrders方法</td>
    </tr>
   <tr>
      <td rowspan="3">OrderController.annulOrder</td>
      <td>语法</td>
      <td>public ResponseVO annulOrder(int orderid);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的annulOrder方法</td>
   </tr>
   <tr>
      <td rowspan="3">OrderController.getAllOrdersByManagerId</td>
      <td>语法</td>
      <td>public ResponseVO getAllOrdersByManagerId(Integer managerId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>酒店管理人员id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的getAllOrdersByManagerId方法</td>
   </tr>
    <tr>
      <td rowspan="3">OrderController.getCommentsByHotelId</td>
      <td>语法</td>
      <td>public ResponseVO getCommentsByHotelId(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>酒店id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的getCommentsByHotelId方法</td>
   </tr>
    <tr>
      <td rowspan="3">OrderController.getHotelOrders</td>
      <td>语法</td>
      <td>public ResponseVO getHotelOrders(Integer hotelId, Integer userId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>酒店id和客户id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的getuserHotelOrders方法</td>
   </tr>
    <tr>
      <td rowspan="3">OrderController.orderDetailById</td>
      <td>语法</td>
      <td>public ResponseVO orderDetailById(Integer id);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的orderDetailbyId方法</td>
   </tr>
    <tr>
      <td rowspan="3">OrderController.rateHotel</td>
      <td>语法</td>
      <td>public ResponseVO rateHotel(Integer orderid, RateVO rateVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用OrderService领域对象的rateHotel方法</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>OrderService.addOrder(OrderVO orderVO)</td>
      <td colspan="2">添加订单</td>
   </tr>
   <tr>
      <td>OrderService.getAllOrders()</td>
      <td colspan="2">获取所有订单</td>
   </tr>
   <tr>
      <td>OrderService.getUserOrders(int userid)</td>
      <td colspan="2">获取某一客户所有订单</td>
   </tr>
   <tr>
      <td>OrderService.annulOrder(int orderid)</td>
      <td colspan="2">撤销订单</td>
   </tr>
   <tr>
      <td>OrderService.getAllOrdersByManagerId(Integer managerId)</td>
      <td colspan="2">获取某一酒店管理人员可查看的所有订单</td>
   </tr>
    <tr>
      <td>OrderService.getCommentsByHotelId(Integer hotelId)</td>
      <td colspan="2">获取某一酒店所有订单评论</td>
   </tr>
    <tr>
      <td>OrderService.getuserHotelOrders(Integer userId,Integer hotelId)</td>
      <td colspan="2">获取某一用户在某一酒店所有订单</td>
   </tr>
    <tr>
      <td>OrderService.orderDetailbyId(Integer id)</td>
      <td colspan="2">获取某一订单的全部信息</td>
   </tr>
    <tr>
      <td>OrderService.rateHotel(Integer orderid,RateVO rateVO)</td>
      <td colspan="2">在某一订单上完成对此次服务的评价</td>
   </tr>
</table>


Order的接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">OrderService.addOrder</td>
      <td>语法</td>
      <td>ResponseVO addOrder(OrderVO orderVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以酒店管理人员身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>将预定订单信息添加到数据库</td>
   </tr>
   <tr>
      <td rowspan="3">OrderService.getAllOrders</td>
      <td>语法</td>
      <td>List<Order> getAllOrders();</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以酒店管理人员身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回所有订单信息</td>
   </tr>
   <tr>
      <td rowspan="3">OrderService.getUserOrders</td>
      <td>语法</td>
      <td>List<Order> getUserOrders(int userid);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以酒店管理人员身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回指定用户的订单信息</td>
   </tr>
   <tr>
      <td rowspan="3">OrderService.annulOrder</td>
      <td>语法</td>
      <td>ResponseVO annulOrder(int orderid);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以酒店管理人员身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>撤销订单</td>
   </tr>
    <tr>
      <td rowspan="3">OrderService.getAllOrdersByManagerId</td>
      <td>语法</td>
      <td>List<Order> getAllOrdersByManagerId(Integer managerId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以酒店管理人员身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回指定订单信息</td>
   </tr>
    <tr>
      <td rowspan="3">OrderService.getCommentsByHotelId</td>
      <td>语法</td>
      <td>List<RateVO> getCommentsByHotelId(Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>无</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>获取某一酒店所有评价</td>
   </tr>
    <tr>
      <td rowspan="3">OrderService.getuserHotelOrders</td>
      <td>语法</td>
      <td>List<Order> getuserHotelOrders(Integer userId, Integer hotelId);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>以客户身份登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回客户在此酒店的所有订单信息</td>
   </tr>
    <tr>
      <td rowspan="3">OrderService.orderDetailbyId</td>
      <td>语法</td>
      <td>Order orderDetailbyId(Integer id);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单id存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回此订单所有内容</td>
   </tr>
    <tr>
      <td rowspan="3">OrderService.rateHotel</td>
      <td>语法</td>
      <td>ResponseVO rateHotel(Integer orderid, RateVO rateVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>订单存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>完成订单的评分评论</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>OrderMapper.addOrder(Order order)</td>
      <td colspan="2">在数据库中添加收到的符合规范的订单信息</td>
   </tr>
   <tr>
      <td>OrderMapper.getAllOrders</td>
      <td colspan="2">得到order数据库的服务与引用</td>
   </tr>
   <tr>
      <td>OrderMapper.getUserOrders(int userid)</td>
      <td colspan="2">根据用户ID查找多个持久化对象</td>
   </tr>
   <tr>
      <td>OrderMapper.annulOrder(int orderid)</td>
      <td colspan="2">根据订单ID删除单个持久化对象</td>
   </tr>
   <tr>
      <td>OrderMapper.getOrderById(int orderid)</td>
      <td colspan="2">根据订单ID查找单个持久化对象</td>
   </tr>
    <tr>
      <td>OrderMapper.getCommentsByHotelId(Integer hotelId)</td>
      <td colspan="2">根据酒店ID查找多个持久化对象</td>
   </tr>
    <tr>
      <td>OrderMapper.getUserHotelOrders(Integer userId,Integer hotelId)</td>
      <td colspan="2">根据客户ID和酒店id查找多个持久化对象</td>
   </tr>
    <tr>
      <td>OrderMapper.getHotelOrders(Integer hotelId)</td>
      <td colspan="2">根据酒店ID查找多个持久化对象</td>
   </tr>
    <tr>
      <td>OrderMapper.rateHotel(Integer orderid,double rate,String comment)</td>
      <td colspan="2">得到order数据库的服务与引用</td>
   </tr>
</table>
（4）业务逻辑层的动态模型

添加订单的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/orderreserveHotel.png)

获得所有订单的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/orderretrieveAllOrders.png)

获得用户所有订单的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/orderretrieveUserOrders.png)

撤销订单的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/orderannulOrder.png)

获得酒店管理人员可见所有订单的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/ordergetAllOrdersByManagerId.png)

获取酒店所有评价的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/ordergetCommentsByHotelId.png)

获取酒店所有订单的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/ordergetHotelOrders.png)

获取订单详情的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/orderorderDetailById.png)

评论评分的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/order/orderrateHotel.png)

（5）业务逻辑层的设计原理

利用委托式的控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域

#### 4.2.5 userbl模块

（1）模块概述

userbl主要负责用户登录的逻辑

（2）整体结构

模块各个类的设计图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/%E6%95%B4%E4%BD%93%E7%BB%93%E6%9E%84/User.jpg)

模块各个类的职责表

| 模块              | 职责                                       |
| ----------------- | ------------------------------------------ |
| AccountController | 负责实现对应登录界面所需要的服务           |
| AccountService    | 用户登录领域模型对象，帮助完成用户登录任务 |

（3）模块内部类接口规范

AccountController的模块接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">AccountController.login</td>
      <td>语法</td>
      <td>public ResponseVO login(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户信息正确</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AccountService领域login的方法</td>
   </tr>
   <tr>
      <td rowspan="3">AccountController.registerAccount</td>
      <td>语法</td>
      <td>public ResponseVO registerAccount(UserVO userVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户信息完整</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AccountService领域的registerAccount方法</td>
   </tr>
   <tr>
      <td rowspan="3">AccountController.getUserInfo</td>
      <td>语法</td>
      <td>public ResponseVO getUserInfo(int id);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AccountService领域的getUserInfo方法</td>
   </tr>
   <tr>
      <td rowspan="3">AccountController.updateInfo</td>
      <td>语法</td>
      <td>public ResponseVO updateInfo(UserInfoVO userInfoVO,@PathVariable int id);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>原用户存在，新用户信息完整</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AccountService领域的updateUserInfo方法</td>
   </tr>
    <tr>
      <td rowspan="3">AccountController.creditdeposit</td>
      <td>语法</td>
      <td>public ResponseVO creditDeposit(CreditdepositVO creditdepositVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>调用AccountService领域的creditdeposit方法</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>AccountService.login(UserForm userForm)</td>
      <td colspan="2">用户登录</td>
   </tr>
   <tr>
      <td>AccountService.registerAccount(UserVO userVO)</td>
      <td colspan="2">添加用户信息</td>
   </tr>
    <tr>
      <td>AccountService.updateUserInfo(int id, String password,String username,String phonenumber)</td>
      <td colspan="2">更新用户信息</td>
   </tr>
   <tr>
      <td>AccountService.creditdeposit(String email,Integer deposit)</td>
      <td colspan="2">查找响应账号</td>
   </tr>
    <tr>
      <td>AccountService.getUserInfo(int id)</td>
      <td colspan="2">查找响应账号</td>
   </tr>
</table>



Account的模块接口与规范

<table>
   <tr>
      <td colspan="3">提供的服务（供接口）</td>
   </tr>
   <tr>
      <td rowspan="3">AccountService.registerAccount</td>
      <td>语法</td>
      <td>ResponseVO registerAccount(UserVO userVO);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>无</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>将用户信息添加到数据库</td>
   </tr>
   <tr>
      <td rowspan="3">AccountService.login</td>
      <td>语法</td>
      <td>User login(UserForm userForm);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>输入信息符合规则</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>查找是否有对应的User并返回结果</td>
   </tr>
   <tr>
      <td rowspan="3">AccountService.getUserInfo</td>
      <td>语法</td>
      <td>User getUserInfo(int id);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>返回用户个人信息</td>
   </tr>
   <tr>
      <td rowspan="3">AccountService.updateUserInfo</td>
      <td>语法</td>
      <td>ResponseVO updateUserInfo(int id, String password,String username,String phonenumber);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户已登录</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>更新用户信息到数据库</td>
   </tr>
    <tr>
      <td rowspan="3">AccountService.creditdeposit</td>
      <td>语法</td>
      <td>ResponseVO creditdeposit(String email, Integer deposit);</td>
   </tr>
   <tr>
      <td>前置条件</td>
      <td>用户邮箱存在</td>
   </tr>
   <tr>
      <td>后置条件</td>
      <td>更新用户信息到数据库</td>
   </tr>
   <tr>
      <td colspan="3">需要的服务（需接口）</td>
   </tr>
   <tr>
      <td>AccountMapper.getAccountById( int id)</td>
      <td colspan="2">得到User数据库的服务与引用</td>
   </tr>
   <tr>
      <td>AccountMapper.updateAccount( int id,  String password,String username,  String phonenumber)</td>
      <td colspan="2">在数据库中修改收到的符合规范的账户信息</td>
   </tr>
    <tr>
      <td>AccountMapper.createNewAccount(User user)</td>
      <td colspan="2">在数据库中添加收到的符合规范的账户信息</td>
   </tr>
    <tr>
      <td>AccountMapper.getAccountByName(String email)</td>
      <td colspan="2">得到User数据库的服务与引用</td>
   </tr>
    <tr>
      <td>AccountMapper.creditDeposit(String email,Integer desposit)</td>
      <td colspan="2">在数据库中修改收到的符合规范的账户信息</td>
   </tr>
</table>

（4）业务逻辑层的动态模型

用户登录的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/account/accountlogin.png)

增加新用户的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/account/accountregisterAccount.png)

获取用户信息的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/account/accountgetUserInfo.png)

更新用户信息的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/account/accountupdateUserInfo.png)

更新用户信用值的顺序图

![](https://silverwind-1301522247.cos.ap-nanjing.myqcloud.com/account/accountcreditDeposit.png)

（5）业务逻辑层的设计原理

利用委托式的控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域

### 4.3 数据层的分解

#### 4.3.1 admin模块

##### （1）模块概述

- 为其他层的admin提供数据

##### （2）整体结构

根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotelmanager的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotelmanager和coupon模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://test-20200309.oss-cn-beijing.aliyuncs.com/admin.png)

###### 模块各个类的职责表

| 类名        | 职责                                    |
| ----------- | --------------------------------------- |
| AdminMapper | 接收数据、调用AdminMapper.xml修改数据库 |

##### （3）模块内部类接口规范

| 接口名：AdminMapper.addManager | 语法：int addManager(User user);                             |
| ------------------------------ | :----------------------------------------------------------- |
|                                | **前置条件**：收到逻辑层关于添加工作人员账户的请求           |
|                                | **后置条件**：在数据库中添加收到的符合规范的工作人员账户信息 |

| 接口名：AdminMapper.getAllManagers | 语法：List<User> getAllManagers();                         |
| ---------------------------------- | :--------------------------------------------------------- |
|                                    | **前置条件**：收到逻辑层关于获得全部工作人员账户信息的请求 |
|                                    | **后置条件**：在数据库中筛选工作人员的账户信息传回         |

| 接口名：AdminMapper.addUser | 语法：int addUser(User user);                            |
| --------------------------- | :------------------------------------------------------- |
|                             | **前置条件**：收到逻辑层关于添加用户账户的请求           |
|                             | **后置条件**：在数据库中添加收到的符合规范的用户账户信息 |

| 接口名：AdminMapper.getAllUsers | 语法：List<User> getAllUsers();                        |
| ------------------------------- | :----------------------------------------------------- |
|                                 | **前置条件**：收到逻辑层关于获得全部用户账户信息的请求 |
|                                 | **后置条件**：在数据库中筛选用户账户信息传回           |

| 接口名：AdminMapper.addMarketer | 语法：int addMarketer(User user);                            |
| ------------------------------- | :----------------------------------------------------------- |
|                                 | **前置条件**：收到逻辑层关于添加营销人员账户的请求           |
|                                 | **后置条件**：在数据库中添加收到的符合规范的营销人员账户信息 |

| 接口名：AdminMapper.getAllMarketerts | 语法：List<User> getAllMarketerts();                       |
| ------------------------------------ | :--------------------------------------------------------- |
|                                      | **前置条件**：收到逻辑层关于获得全部营销人员账户信息的请求 |
|                                      | **后置条件**：在数据库中筛选营销人员账户信息传回           |

| 接口名：AdminMapper.deleteUser | 语法：int deleteUser(Integer userid);                      |
| ------------------------------ | :--------------------------------------------------------- |
|                                | **前置条件**：收到逻辑层关于获得删除某个用户账户信息的请求 |
|                                | **后置条件**：在数据库中根据传入的用户id进行筛选然后删除   |

##### （4）数据层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，通过被调用确定数据走向与数据更改。

#### 4.3.2 Coupon模块

##### （1）模块概述

- 为其他层的coupon相关类提供数据

##### （2）整体结构

根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotelmanager的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotelmanager和coupon模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://test-20200309.oss-cn-beijing.aliyuncs.com/coupon.png)

###### 模块各个类的职责表

| 类名         | 职责                                     |
| ------------ | ---------------------------------------- |
| CouponMapper | 接收数据、调用CouponMapper.xml修改数据库 |

##### （3）模块内部类接口规范

| 接口名：CouponMapper.insertCoupon | 语法：int insertCoupon(Coupon coupon);                 |
| --------------------------------- | :----------------------------------------------------- |
|                                   | **前置条件**：收到逻辑层关于添加优惠券信息的请求       |
|                                   | **后置条件**：在数据库中添加收到的符合规范的优惠券信息 |

| 接口名：CouponMapper.selectByHotelId | 语法：List<Coupon> selectByHotelId(Integer hotelId);     |
| ------------------------------------ | :------------------------------------------------------- |
|                                      | **前置条件**：收到逻辑层关于根据酒店ID选择优惠券的请求   |
|                                      | **后置条件**：在数据库中根据ID筛选对应的优惠券信息并传回 |

##### （4）数据层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，通过被调用确定数据走向与数据更改。

#### 4.3.3 Hotel模块

##### （1）模块概述

- 为其他层的hotel、room相关类提供数据

##### （2）整体结构

根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotelmanager的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotelmanager和coupon模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://test-20200309.oss-cn-beijing.aliyuncs.com/hotel.png)

![](https://test-20200309.oss-cn-beijing.aliyuncs.com/room.png)

###### 模块各个类的职责表

| 类名        | 职责                                    |
| ----------- | --------------------------------------- |
| HotelMapper | 接收数据、调用HotelMapper.xml修改数据库 |
| RoomMapper  | 接收数据、调用RoomMapper.xml修改数据库  |

##### （3）模块内部类接口规范

| 接口名：HotelMapper.insertHotel | 语法：int insertHotel(Hotel hotel);                  |
| ------------------------------- | :--------------------------------------------------- |
|                                 | **前置条件**：收到逻辑层关于添加酒店信息的请求       |
|                                 | **后置条件**：在数据库中添加收到的符合规范的酒店信息 |

| 接口名：HotelMapper.selectAllHotel | 语法：List<HotelVO> selectAllHotel();              |
| ---------------------------------- | :------------------------------------------------- |
|                                    | **前置条件**：收到逻辑层关于选择全部酒店信息的请求 |
|                                    | **后置条件**：在数据库中筛选全部的酒店信息并传回   |

| 接口名：HotelMapper.selectById | 语法：HotelVO selectById( Integer id);                       |
| ------------------------------ | :----------------------------------------------------------- |
|                                | **前置条件**：收到逻辑层关于选择某个酒店的请求               |
|                                | **后置条件**：根据输入的酒店ID在数据库中筛选对应的酒店信息并传回 |

| 接口名：RoomMapper.updateRoomInfo | 语法：int updateRoomInfo(Integer hotelId, String roomType, Integer curNum); |
| --------------------------------- | :----------------------------------------------------------- |
|                                   | **前置条件**：收到逻辑层关于更新房间信息的请求               |
|                                   | **后置条件**：在数据库中添加收到的符合规范的房间信息         |

| 接口名：RoomMapper.selectRoomsByHotelId | 语法：List<HotelRoom> selectRoomsByHotelId( Integer hotelId); |
| --------------------------------------- | :----------------------------------------------------------- |
|                                         | **前置条件**：收到逻辑层关于选择某个酒店房间的请求           |
|                                         | **后置条件**：根据酒店ID在数据库中筛选对应的房间信息并传回   |

| 接口名：RoomMapper.insertRoom | 语法：int insertRoom(HotelRoom hotelRoom);           |
| ----------------------------- | :--------------------------------------------------- |
|                               | **前置条件**：收到逻辑层关于添加房间的请求           |
|                               | **后置条件**：在数据库中添加收到的符合规范的房间信息 |

| 接口名：RoomMapper.getRoomCurNum | 语法：int getRoomCurNum( Integer hotelId,String roomType);   |
| -------------------------------- | :----------------------------------------------------------- |
|                                  | **前置条件**：收到逻辑层关于查看某个类型的房间的剩余数的请求 |
|                                  | **后置条件**：根据酒店ID与房间类型在数据库中筛选对应类型房间并传回未被入住的房间的数量 |

##### （4）数据层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，通过被调用确定数据走向与数据更改。

#### 4.3.4 Order模块

##### （1）模块概述

- 为其他层的order相关类提供数据

##### （2）整体结构

根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotelmanager的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotelmanager和coupon模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://test-20200309.oss-cn-beijing.aliyuncs.com/order.png)

###### 模块各个类的职责表

| 类名        | 职责                                    |
| ----------- | --------------------------------------- |
| OrderMapper | 接收数据、调用OrderMapper.xml修改数据库 |

##### （3）模块内部类接口规范

| 接口名：OrderMapper.addOrder | 语法：int addOrder(Order order);               |
| ---------------------------- | :--------------------------------------------- |
|                              | **前置条件**：收到逻辑层关于添加订单的请求     |
|                              | **后置条件**：在数据库中添加符合规范的订单信息 |

| 接口名：OrderMapper.getAllOrders | 语法：List<Order> getAllOrders();                  |
| -------------------------------- | :------------------------------------------------- |
|                                  | **前置条件**：收到逻辑层关于得到全部订单信息的请求 |
|                                  | **后置条件**：在数据库中筛选全部订单信息并返回     |

| 接口名：OrderMapper.getUserOrders | 语法：List<Order> getUserOrders(int userid);                 |
| --------------------------------- | :----------------------------------------------------------- |
|                                   | **前置条件**：收到逻辑层关于查看某个用户的全部订单信息的请求 |
|                                   | **后置条件**：根据用户ID在数据库中筛选对应的订单信息并传回   |

| 接口名：OrderMapper.annulOrder | 语法：int annulOrder(int orderid);                 |
| ------------------------------ | :------------------------------------------------- |
|                                | **前置条件**：收到逻辑层关于取消某个订单的请求     |
|                                | **后置条件**：根据订单ID在数据库中删除对应订单信息 |

| 接口名：OrderMapper.getOrderById | 语法：Order getOrderById(int orderid);                   |
| -------------------------------- | :------------------------------------------------------- |
|                                  | **前置条件**：收到逻辑层关于获得某个订单信息的请求       |
|                                  | **后置条件**：根据订单ID在数据库中筛选对应订单信息并传回 |

##### （4）数据层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，通过被调用确定数据走向与数据更改。

#### 4.3.5 User模块

##### （1）模块概述

- 为其他层的user相关类提供数据

##### （2）整体结构

根据体系结构的要求，我们将系统分为展示层，业务逻辑层，数据层，为了增加每一层的灵活性，我们会设计接口。hotelmanager的页面中会受到由用户点击传来的数据以及方法，然后将数据传给hotelmanager和coupon模块中的api，再利用api将前端数据传给后端，再由api得到返回的数据，这样就完成了展示层和业务逻辑层的分离以及接口的调用。

###### 模块各个类的设计图

![](https://test-20200309.oss-cn-beijing.aliyuncs.com/user.png)

###### 模块各个类的职责表

| 类名          | 职责                                      |
| ------------- | ----------------------------------------- |
| AccountMapper | 接收数据、调用AccountMapper.xml修改数据库 |

##### （3）模块内部类接口规范

| 接口名：AccountMapper.createNewAccount | 语法：int createNewAccount(User user);             |
| -------------------------------------- | :------------------------------------------------- |
|                                        | **前置条件**：收到逻辑层关于创建新的账户的请求     |
|                                        | **后置条件**：在数据库中添加符合规范的用户账户信息 |

| 接口名：AccountMapper.getAccountByName | 语法：User getAccountByName(String email);                |
| -------------------------------------- | :-------------------------------------------------------- |
|                                        | **前置条件**：收到逻辑层关于根据用户名查找用户信息的请求  |
|                                        | **后置条件**：根据email在数据库中筛选对应的用户信息并传回 |

| 接口名：AccountMapper.getAccountById | 语法：User getAccountById( int id);                        |
| ------------------------------------ | :--------------------------------------------------------- |
|                                      | **前置条件**：收到逻辑层关于根据用户ID查找用户信息的请求   |
|                                      | **后置条件**：根据用户ID在数据库中筛选对应的用户信息并传回 |

| 接口名：AccountMapper.updateAccount | 语法：int updateAccount( int id,  String password,String username,  String phonenumber); |
| ----------------------------------- | :----------------------------------------------------------- |
|                                     | **前置条件**：收到逻辑层关于更新用户信息的请求               |
|                                     | **后置条件**：根据用户ID在数据库中筛选对应的用户并更新对应信息 |

##### （4）数据层的设计原理

- 利用委托式控制风格，将各个方法分配给各个界面模块，通过被调用确定数据走向与数据更改。

## 5. 依赖视角

服务器端开发包之间的依赖关系如下图所示

![服务器端开发包图](https://kashimiya.oss-cn-hangzhou.aliyuncs.com/3%20%281%29.png)